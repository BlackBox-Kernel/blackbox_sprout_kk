--- drivers/iommu/intel-iommu.c
+++ drivers/iommu/intel-iommu.c
@@ -1788,7 +1784,7 @@
 	struct dma_pte *first_pte = NULL, *pte = NULL;
 	phys_addr_t uninitialized_var(pteval);
 	int addr_width = agaw_to_width(domain->agaw) - VTD_PAGE_SHIFT;
-	unsigned long sg_res = 0;
+	unsigned long sg_res;
 	unsigned int largepage_lvl = 0;
 	unsigned long lvl_pages = 0;
 
@@ -1799,8 +1795,10 @@
 
 	prot &= DMA_PTE_READ | DMA_PTE_WRITE | DMA_PTE_SNP;
 
-	if (!sg) {
-		sg_res = nr_pages;
+	if (sg)
+		sg_res = 0;
+	else {
+		sg_res = nr_pages + 1;
 		pteval = ((phys_addr_t)phys_pfn << VTD_PAGE_SHIFT) | prot;
 	}
 
