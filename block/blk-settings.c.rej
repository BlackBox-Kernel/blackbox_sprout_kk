--- block/blk-settings.c
+++ block/blk-settings.c
@@ -537,7 +536,7 @@
 		bottom = max(b->physical_block_size, b->io_min) + alignment;
 
 		/* Verify that top and bottom intervals line up */
-		if (max(top, bottom) % min(top, bottom)) {
+		if (max(top, bottom) & (min(top, bottom) - 1)) {
 			t->misaligned = 1;
 			ret = -1;
 		}
@@ -578,7 +577,7 @@
 
 	/* Find lowest common alignment_offset */
 	t->alignment_offset = lcm(t->alignment_offset, alignment)
-		% max(t->physical_block_size, t->io_min);
+		& (max(t->physical_block_size, t->io_min) - 1);
 
 	/* Verify that new alignment_offset is on a logical block boundary */
 	if (t->alignment_offset & (t->logical_block_size - 1)) {
